!function(){"use strict";Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_glav",type:"select",values:{1:"Скрыть",0:"Отображать"},default:"0"},field:{name:"Логотипы вместо названий",description:"Отображает логотипы фильмов вместо текста"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_lang",type:"select",values:{"":"Как в Lampa",ru:"Русский",en:"English",uk:"Українська",be:"Беларуская",kz:"Қазақша",pt:"Português",es:"Español",fr:"Français",de:"Deutsch",it:"Italiano"},default:""},field:{name:"Язык логотипа",description:"Приоритетный язык для поиска логотипа"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_size",type:"select",values:{w300:"w300",w500:"w500",w780:"w780",original:"Оригинал"},default:"original"},field:{name:"Размер логотипа",description:"Разрешение загружаемого изображения"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_clear_cache",type:"button"},field:{name:"Сбросить кеш логотипов",description:"Нажмите для очистки кеша изображений"},onChange:function(){Lampa.Select.show({title:"Сбросить кеш?",items:[{title:"Да",confirm:!0},{title:"Нет"}],onSelect:function(e){if(e.confirm){for(var t=[],o=0;o<localStorage.length;o++){var a=localStorage.key(o);-1!==a.indexOf("logo_cache_width_based_v1_")&&t.push(a)}t.forEach((function(e){localStorage.removeItem(e)})),window.location.reload()}else Lampa.Controller.toggle("settings_component")},onBack:function(){Lampa.Controller.toggle("settings_component")}})}}),window.logoplugin||function(){function e(e,t){t&&(t.style.height="",t.style.overflow="",t.style.display="",t.style.transition="none"),e.style.marginTop="0",e.style.marginLeft="0",e.style.paddingTop="0.2em",e.style.width="8em",e.style.height="auto",e.style.maxHeight="none",e.style.maxWidth="100%",e.style.boxSizing="border-box",e.style.display="block",e.style.objectFit="contain",e.style.objectPosition="left bottom",e.style.opacity="1",e.style.transition="none"}window.logoplugin=!0,Lampa.Listener.follow("full",(function(t){if("complite"==t.type&&"1"!=Lampa.Storage.get("logo_glav")){var o=t.data.movie,a=o.name?"tv":"movie",n=t.object.activity.render().find(".full-start-new__title"),i=n[0],l=Lampa.Storage.get("logo_lang",""),s=l||Lampa.Storage.get("language"),r=Lampa.Storage.get("logo_size","original"),g=function(e,t,o){return"logo_cache_width_based_v1_"+e+"_"+t+"_"+o}(a,o.id,s),c=Lampa.Storage.get(g);if(c&&"none"!==c){var p=new Image;return p.src=c,e(p,null),n.empty().append(p),void n.css({opacity:"1",transition:"none"})}if(n.css({opacity:"1",transition:"none"}),""!=o.id){var m=0;requestAnimationFrame((function(){i&&(m=i.getBoundingClientRect().height)}));var f=Lampa.TMDB.api(a+"/"+o.id+"/images?api_key="+Lampa.TMDB.key()+"&include_image_language="+s+",en,null");$.get(f,(function(t){var o=null;if(t.logos&&t.logos.length>0){for(var a=0;a<t.logos.length;a++)if(t.logos[a].iso_639_1==s){o=t.logos[a].file_path;break}if(!o)for(var l=0;l<t.logos.length;l++)if("en"==t.logos[l].iso_639_1){o=t.logos[l].file_path;break}o||(o=t.logos[0].file_path)}if(o){var c=Lampa.TMDB.image("/t/p/"+r+o.replace(".svg",".png"));Lampa.Storage.set(g,c);var p=new Image;p.src=c,e(p,null),p.style.opacity="0",p.onload=function(){setTimeout((function(){i&&(m=i.getBoundingClientRect().height),n.css({transition:"opacity 0.3s ease",opacity:"0"}),setTimeout((function(){n.empty(),n.append(p),n.css({opacity:"1",transition:"none"});var t=i.getBoundingClientRect().height;i.style.height=m+"px",i.style.display="block",i.style.overflow="hidden",i.offsetHeight,i.style.transition="height 0.4s cubic-bezier(0.4, 0, 0.2, 1)",requestAnimationFrame((function(){i.style.height=t+"px",setTimeout((function(){p.style.transition="opacity 0.4s ease",p.style.opacity="1"}),300),setTimeout((function(){e(p,i)}),850)}))}),300)}),200)},p.onerror=function(){Lampa.Storage.set(g,"none"),n.css({opacity:"1",transition:"none"})}}else Lampa.Storage.set(g,"none")})).fail((function(){}))}}}))}()}();
