!function(){"use strict";Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_glav",type:"select",values:{1:"Скрыть",0:"Отображать"},default:"0"},field:{name:"Логотипы вместо названий",description:"Отображает логотипы фильмов вместо текста"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_lang",type:"select",values:{"":"Как в Lampa",ru:"Русский",en:"English",uk:"Українська",be:"Беларуская",kz:"Қазақша",pt:"Português",es:"Español",fr:"Français",de:"Deutsch",it:"Italiano"},default:""},field:{name:"Язык логотипа",description:"Приоритетный язык для поиска логотипа"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_size",type:"select",values:{w300:"w300",w500:"w500",w780:"w780",original:"Оригинал"},default:"original"},field:{name:"Размер логотипа",description:"Разрешение загружаемого изображения"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_animation_type",type:"select",values:{js:"JavaScript",css:"CSS"},default:"css"},field:{name:"Тип анимации логотипов",description:"Способ анимации логотипов"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_hide_year",type:"trigger",default:!0},field:{name:"Скрывать год и страну",description:"Скрывать информацию над логотипом"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_use_text_height",type:"trigger",default:!1},field:{name:"Логотип по высоте текста",description:"Размер логотипа равен высоте текста"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_clear_cache",type:"button"},field:{name:"Сбросить кеш логотипов",description:"Нажмите для очистки кеша изображений"},onChange:function(){Lampa.Select.show({title:"Сбросить кеш?",items:[{title:"Да",confirm:!0},{title:"Нет"}],onSelect:function(e){if(e.confirm){for(var t=[],a=0;a<localStorage.length;a++){var n=localStorage.key(a);-1!==n.indexOf("logo_cache_width_based_v1_")&&t.push(n)}t.forEach((function(e){localStorage.removeItem(e)})),window.location.reload()}else Lampa.Controller.toggle("settings_component")},onBack:function(){Lampa.Controller.toggle("settings_component")}})}}),window.logoplugin||function(){var e=300,t=400,a=400,n=Lampa.Storage.get("logo_hide_year",!0)?0:.3;function i(e,t,a,n,i){var o=null;requestAnimationFrame((function s(l){o||(o=l);var r=l-o,c=Math.min(r/n,1),g=1-Math.pow(1-c,3);e.style.opacity=t+(a-t)*g,r<n?requestAnimationFrame(s):i&&i()}))}function o(e,t,a,i){t&&(t.style.height="",t.style.overflow="",t.style.display="",t.style.transition="none",t.style.boxSizing=""),e.style.marginTop="0",e.style.marginLeft="0",e.style.paddingTop=n+"em";var o=.2;window.innerWidth<768&&a&&(o=.5),e.style.paddingBottom=o+"em",Lampa.Storage.get("logo_use_text_height",!1)&&i?(e.style.height=i+"px",e.style.width="auto",e.style.maxWidth="100%",e.style.maxHeight="none"):window.innerWidth<768?(e.style.width="100%",e.style.height="auto",e.style.maxWidth="100%",e.style.maxHeight="none"):(e.style.width="7em",e.style.height="auto",e.style.maxHeight="none",e.style.maxWidth="100%"),e.style.boxSizing="border-box",e.style.display="block",e.style.objectFit="contain",e.style.objectPosition="left bottom",e.style.opacity="1",e.style.transition="none"}window.logoplugin=!0,Lampa.Listener.follow("full",(function(n){if("complite"==n.type&&"1"!=Lampa.Storage.get("logo_glav")){var s=n.data.movie,l=s.name?"tv":"movie",r=n.object.activity.render().find(".full-start-new__title"),c=n.object.activity.render().find(".full-start-new__head"),g=n.object.activity.render().find(".full-start-new__details"),p=n.object.activity.render().find(".full-start-new__tagline"),m=p.length>0&&""!==p.text().trim(),d=r[0],f=Lampa.Storage.get("logo_lang",""),y=f||Lampa.Storage.get("language"),u=Lampa.Storage.get("logo_size","original"),h=function(e,t,a){return"logo_cache_width_based_v1_"+e+"_"+t+"_"+a}(l,s.id,y);function w(t,n){if(c.length&&g.length&&!(g.find(".logo-moved-head").length>0)&&Lampa.Storage.get("logo_hide_year",!0)){var o=c.html();if(o){var s=$('<span class="logo-moved-head">'+o+"</span>"),l=$('<span class="full-start-new__split logo-moved-separator">●</span>');t?(s.css({opacity:0,marginLeft:"0.6em",transition:"none"}),l.css({opacity:0,transition:"none"}),g.children().length>0&&g.append(l),g.append(s),"js"===n?(c.css("transition","none"),i(c[0],1,0,e,(function(){i(s[0],0,1,a),i(l[0],0,1,a)}))):(c.css({transition:"opacity 0.3s ease",opacity:"0"}),setTimeout((function(){s.css({transition:"opacity 0.4s ease",opacity:"1"}),l.css({transition:"opacity 0.4s ease",opacity:"1"})}),e))):(c.css("opacity","0"),g.children().length>0&&g.append(l),g.append(s))}}}Lampa.Storage.get(h);if(r.css({opacity:"1",transition:"none"}),""!=s.id){var _=0;requestAnimationFrame((function(){d&&(_=d.getBoundingClientRect().height)}));var v=Lampa.TMDB.api(l+"/"+s.id+"/images?api_key="+Lampa.TMDB.key()+"&include_image_language="+y+",en,null");$.get(v,(function(n){var s=null;if(n.logos&&n.logos.length>0){for(var l=0;l<n.logos.length;l++)if(n.logos[l].iso_639_1==y){s=n.logos[l].file_path;break}if(!s)for(var c=0;c<n.logos.length;c++)if("en"==n.logos[c].iso_639_1){s=n.logos[c].file_path;break}s||(s=n.logos[0].file_path)}if(s){var g=Lampa.TMDB.image("/t/p/"+u+s.replace(".svg",".png"));0;var p=new Image;p.src=g,o(p,null,m,_),p.style.opacity="0",p.onload=function(){setTimeout((function(){d&&(_=d.getBoundingClientRect().height);var n=Lampa.Storage.get("logo_animation_type","css");w(!0,n),"js"===n?(r.css({transition:"none"}),i(d,1,0,e,(function(){r.empty(),r.append(p),r.css({opacity:"1",transition:"none"});var e,n,s,l,c,g,f=d.getBoundingClientRect().height;d.style.height=_+"px",d.style.display="block",d.style.overflow="hidden",d.style.boxSizing="border-box",d.offsetHeight,d.style.transition="none",e=d,n=_,s=f,l=t,c=function(){setTimeout((function(){o(p,d,m,_)}),450)},g=null,requestAnimationFrame((function t(a){g||(g=a);var i=a-g,o=Math.min(i/l,1),r=1-Math.pow(1-o,3);e.style.height=n+(s-n)*r+"px",i<l?requestAnimationFrame(t):c&&c()})),setTimeout((function(){p.style.transition="none",i(p,0,1,a)}),Math.max(0,300))}))):(r.css({transition:"opacity 0.3s ease",opacity:"0"}),setTimeout((function(){r.empty(),r.append(p),r.css({opacity:"1",transition:"none"});var e=d.getBoundingClientRect().height;d.style.height=_+"px",d.style.display="block",d.style.overflow="hidden",d.style.boxSizing="border-box",d.offsetHeight,d.style.transition="height 0.4s cubic-bezier(0.4, 0, 0.2, 1)",requestAnimationFrame((function(){d.style.height=e+"px",setTimeout((function(){p.style.transition="opacity 0.4s ease",p.style.opacity="1"}),Math.max(0,300)),setTimeout((function(){o(p,d,m,_)}),850)}))}),e))}),200)},p.onerror=function(){r.css({opacity:"1",transition:"none"})}}else 0})).fail((function(){}))}}}))}()}();
