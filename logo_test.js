!function(){"use strict";Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_glav",type:"select",values:{1:"Скрыть",0:"Отображать"},default:"0"},field:{name:"Логотипы вместо названий",description:"Отображает логотипы фильмов вместо текста"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_lang",type:"select",values:{"":"Как в Lampa",ru:"Русский",en:"English",uk:"Українська",be:"Беларуская",kz:"Қазақша",pt:"Português",es:"Español",fr:"Français",de:"Deutsch",it:"Italiano"},default:""},field:{name:"Язык логотипа",description:"Приоритетный язык для поиска логотипа"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_size",type:"select",values:{w300:"w300",w500:"w500",w780:"w780",original:"Оригинал"},default:"original"},field:{name:"Размер логотипа",description:"Разрешение загружаемого изображения"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_animation_type",type:"select",values:{js:"JavaScript",css:"CSS"},default:"css"},field:{name:"Тип анимации логотипов",description:"Способ анимации логотипов"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_clear_cache",type:"button"},field:{name:"Сбросить кеш логотипов",description:"Нажмите для очистки кеша изображений"},onChange:function(){Lampa.Select.show({title:"Сбросить кеш?",items:[{title:"Да",confirm:!0},{title:"Нет"}],onSelect:function(e){if(e.confirm){for(var t=[],n=0;n<localStorage.length;n++){var a=localStorage.key(n);-1!==a.indexOf("logo_cache_width_based_v1_")&&t.push(a)}t.forEach((function(e){localStorage.removeItem(e)})),window.location.reload()}else Lampa.Controller.toggle("settings_component")},onBack:function(){Lampa.Controller.toggle("settings_component")}})}}),window.logoplugin||function(){var e=400,t=400;function n(e,t,n,a,o){var i=null;requestAnimationFrame((function l(s){i||(i=s);var r=s-i,c=Math.min(r/a,1),g=1-Math.pow(1-c,3);e.style.opacity=t+(n-t)*g,r<a?requestAnimationFrame(l):o&&o()}))}function a(e,t){t&&(t.style.height="",t.style.overflow="",t.style.display="",t.style.transition="none",t.style.boxSizing=""),e.style.marginTop="0",e.style.marginLeft="0",e.style.paddingTop="0.2em",e.style.width="7em",e.style.height="auto",e.style.maxHeight="none",e.style.maxWidth="100%",e.style.boxSizing="border-box",e.style.display="block",e.style.objectFit="contain",e.style.objectPosition="left bottom",e.style.opacity="1",e.style.transition="none"}window.logoplugin=!0,Lampa.Listener.follow("full",(function(o){if("complite"==o.type&&"1"!=Lampa.Storage.get("logo_glav")){var i=o.data.movie,l=i.name?"tv":"movie",s=o.object.activity.render().find(".full-start-new__title"),r=s[0],c=Lampa.Storage.get("logo_lang",""),g=c||Lampa.Storage.get("language"),p=Lampa.Storage.get("logo_size","original"),m=function(e,t,n){return"logo_cache_width_based_v1_"+e+"_"+t+"_"+n}(l,i.id,g),u=Lampa.Storage.get(m);if(u&&"none"!==u){var f=new Image;return f.src=u,a(f,null),s.empty().append(f),void s.css({opacity:"1",transition:"none"})}if(s.css({opacity:"1",transition:"none"}),""!=i.id){var y=0;requestAnimationFrame((function(){r&&(y=r.getBoundingClientRect().height)}));var d=Lampa.TMDB.api(l+"/"+i.id+"/images?api_key="+Lampa.TMDB.key()+"&include_image_language="+g+",en,null");$.get(d,(function(o){var i=null;if(o.logos&&o.logos.length>0){for(var l=0;l<o.logos.length;l++)if(o.logos[l].iso_639_1==g){i=o.logos[l].file_path;break}if(!i)for(var c=0;c<o.logos.length;c++)if("en"==o.logos[c].iso_639_1){i=o.logos[c].file_path;break}i||(i=o.logos[0].file_path)}if(i){var u=Lampa.TMDB.image("/t/p/"+p+i.replace(".svg",".png"));Lampa.Storage.set(m,u);var f=new Image;f.src=u,a(f,null),f.style.opacity="0",f.onload=function(){setTimeout((function(){r&&(y=r.getBoundingClientRect().height),"js"===Lampa.Storage.get("logo_animation_type","css")?(s.css({transition:"none"}),n(r,1,0,300,(function(){s.empty(),s.append(f),s.css({opacity:"1",transition:"none"});var o,i,l,c,g,p,m=r.getBoundingClientRect().height;r.style.height=y+"px",r.style.display="block",r.style.overflow="hidden",r.style.boxSizing="border-box",r.offsetHeight,r.style.transition="none",o=r,i=y,l=m,c=e,g=function(){setTimeout((function(){a(f,r)}),450)},p=null,requestAnimationFrame((function e(t){p||(p=t);var n=t-p,a=Math.min(n/c,1),s=1-Math.pow(1-a,3);o.style.height=i+(l-i)*s+"px",n<c?requestAnimationFrame(e):g&&g()})),setTimeout((function(){f.style.transition="none",n(f,0,1,t)}),Math.max(0,300))}))):(s.css({transition:"opacity 0.3s ease",opacity:"0"}),setTimeout((function(){s.empty(),s.append(f),s.css({opacity:"1",transition:"none"});var e=r.getBoundingClientRect().height;r.style.height=y+"px",r.style.display="block",r.style.overflow="hidden",r.style.boxSizing="border-box",r.offsetHeight,r.style.transition="height 0.4s cubic-bezier(0.4, 0, 0.2, 1)",requestAnimationFrame((function(){r.style.height=e+"px",setTimeout((function(){f.style.transition="opacity 0.4s ease",f.style.opacity="1"}),Math.max(0,300)),setTimeout((function(){a(f,r)}),850)}))}),300))}),200)},f.onerror=function(){Lampa.Storage.set(m,"none"),s.css({opacity:"1",transition:"none"})}}else Lampa.Storage.set(m,"none")})).fail((function(){}))}}}))}()}();
