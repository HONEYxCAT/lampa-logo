!function(){"use strict";Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_glav",type:"select",values:{1:"Скрыть",0:"Отображать"},default:"0"},field:{name:"Логотипы вместо названий",description:"Отображает логотипы фильмов вместо текста"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_lang",type:"select",values:{"":"Как в Lampa",ru:"Русский",en:"English",uk:"Українська",be:"Беларуская",kz:"Қазақша",pt:"Português",es:"Español",fr:"Français",de:"Deutsch",it:"Italiano"},default:""},field:{name:"Язык логотипа",description:"Приоритетный язык для поиска логотипа"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_size",type:"select",values:{w300:"w300",w500:"w500",w780:"w780",original:"Оригинал"},default:"original"},field:{name:"Размер логотипа",description:"Разрешение загружаемого изображения"}}),Lampa.SettingsApi.addParam({component:"interface",param:{name:"logo_clear_cache",type:"button"},field:{name:"Сбросить кеш логотипов",description:"Нажмите для очистки кеша изображений"},onChange:function(){Lampa.Select.show({title:"Сбросить кеш?",items:[{title:"Да",confirm:!0},{title:"Нет"}],onSelect:function(e){if(e.confirm){for(var t=[],n=0;n<localStorage.length;n++){var o=localStorage.key(n);-1!==o.indexOf("logo_cache_width_based_v1_")&&t.push(o)}t.forEach((function(e){localStorage.removeItem(e)})),window.location.reload()}else Lampa.Controller.toggle("settings_component")},onBack:function(){Lampa.Controller.toggle("settings_component")}})}}),window.logoplugin||function(){function e(e,t,n,o,a){var i=null;requestAnimationFrame((function l(s){i||(i=s);var r=s-i,g=Math.min(r/o,1),c=1-Math.pow(1-g,3);e.style.opacity=t+(n-t)*c,r<o?requestAnimationFrame(l):a&&a()}))}function t(e,t){t&&(t.style.height="",t.style.overflow="",t.style.display="",t.style.transition="none",t.style.boxSizing=""),e.style.marginTop="0",e.style.marginLeft="0",e.style.paddingTop="0.2em",e.style.width="8em",e.style.height="auto",e.style.maxHeight="none",e.style.maxWidth="100%",e.style.boxSizing="border-box",e.style.display="block",e.style.objectFit="contain",e.style.objectPosition="left bottom",e.style.opacity="1",e.style.transition="none"}window.logoplugin=!0,Lampa.Listener.follow("full",(function(n){if("complite"==n.type&&"1"!=Lampa.Storage.get("logo_glav")){var o=n.data.movie,a=o.name?"tv":"movie",i=n.object.activity.render().find(".full-start-new__title"),l=i[0],s=Lampa.Storage.get("logo_lang",""),r=s||Lampa.Storage.get("language"),g=Lampa.Storage.get("logo_size","original"),c=function(e,t,n){return"logo_cache_width_based_v1_"+e+"_"+t+"_"+n}(a,o.id,r);Lampa.Storage.get(c);if(i.css({opacity:"1",transition:"none"}),""!=o.id){var m=0;requestAnimationFrame((function(){l&&(m=l.getBoundingClientRect().height)}));var p=Lampa.TMDB.api(a+"/"+o.id+"/images?api_key="+Lampa.TMDB.key()+"&include_image_language="+r+",en,null");$.get(p,(function(n){var o=null;if(n.logos&&n.logos.length>0){for(var a=0;a<n.logos.length;a++)if(n.logos[a].iso_639_1==r){o=n.logos[a].file_path;break}if(!o)for(var s=0;s<n.logos.length;s++)if("en"==n.logos[s].iso_639_1){o=n.logos[s].file_path;break}o||(o=n.logos[0].file_path)}if(o){var c=Lampa.TMDB.image("/t/p/"+g+o.replace(".svg",".png"));0;var p=new Image;p.src=c,t(p,null),p.style.opacity="0",p.onload=function(){setTimeout((function(){l&&(m=l.getBoundingClientRect().height),i.css({transition:"none"}),e(l,1,0,300,(function(){i.empty(),i.append(p),i.css({opacity:"1",transition:"none"});var n,o,a,s,r,g,c=l.getBoundingClientRect().height;l.style.height=m+"px",l.style.display="block",l.style.overflow="hidden",l.style.boxSizing="border-box",l.offsetHeight,l.style.transition="none",n=l,o=m,a=c,s=400,r=function(){setTimeout((function(){t(p,l)}),450)},g=null,requestAnimationFrame((function e(t){g||(g=t);var i=t-g,l=Math.min(i/s,1),c=1-Math.pow(1-l,3);n.style.height=o+(a-o)*c+"px",i<s?requestAnimationFrame(e):r&&r()})),setTimeout((function(){p.style.transition="none",e(p,0,1,400)}),Math.max(0,300))}))}),200)},p.onerror=function(){i.css({opacity:"1",transition:"none"})}}else 0})).fail((function(){}))}}}))}()}();
